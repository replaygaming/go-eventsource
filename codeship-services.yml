data:
  image: busybox
  volumes:
    - ./tmp:/artifacts

compile:
  build:
    image: us.gcr.io/replay-gaming/go-eventsource-compile
    dockerfile_path: Dockerfile.build
  volumes_from:
    - data
  cached: true

dist:
  build:
    image: us.gcr.io/replay-gaming/go-eventsource
    dockerfile_path: Dockerfile.dist
  volumes_from:
    - data

deploy:
  build:
    image: us.gcr.io/replay-gaming/deploy
    dockerfile_path: Dockerfile.deploy
  # environment:
  #   GOOGLE_CONTAINER_NAME: us.gcr.io/replay-gaming/go-eventsource
  #   DEFAULT_ZONE: us-central1-c
  # encrypted_env_file: google_deployment.env.encrypted
  # add_docker: true
  # cached: true
