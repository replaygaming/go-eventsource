data:
  image: busybox
  volumes:
    - ./tmp:/artifacts

gcr_dockercfg:
  image: codeship/gcr-dockercfg-generator
  add_docker: true
  encrypted_env_file: google_deployment.env.encrypted

compile:
  build:
    image: us.gcr.io/replay-gaming/go-eventsource-compile
    dockerfile_path: Dockerfile.build
  volumes_from:
    - data
  cached: true

dist:
  build:
    image: us.gcr.io/replay-gaming/go-eventsource
    dockerfile_path: Dockerfile.dist
  volumes_from:
    - data

deploy:
  image: busybox
